# 个人信息补充方案

## 目标
收集用户个人信息，用于提升占卜和疗愈的准确性。

## 流程设计

### 6步信息收集流程

#### 第1步：希望怎么称呼你？
- **类型**：文本输入
- **必填**：待确认
- **说明**：用于个性化称呼，如"小A"、"小明"等
- **输入限制**：建议2-10个字符

#### 第2步：你的性别
- **类型**：单选
- **必填**：是
- **选项**：
  - 男
  - 女
  - 非二元（Non-binary）
- **说明**：用于占卜和疗愈的个性化

#### 第3步：你的生日
- **类型**：日期选择器（年月日）
- **必填**：是
- **功能**：
  - 自动计算并显示星座
  - 验证日期有效性（不能是未来日期）
- **显示**：选择日期后，下方显示"你的星座：XX座"

#### 第4步：你的出生时间
- **类型**：时间选择器（小时）+ "不知道"选项
- **必填**：否
- **选项**：
  - 时间选择器：00:00 - 23:00（按小时选择）
  - 或选择"我不知道"
- **说明**：用于更精确的占星计算

#### 第5步：你的出生地
- **类型**：文本输入（具体到城市）
- **必填**：否
- **功能**：
  - 输入城市名称
  - 可选：提供地理位置自动识别
- **说明**：用于时区和地理位置相关的占卜

#### 第6步：你大多数日子更像哪种天气
- **类型**：图标选择（5种天气图标）
- **必填**：否
- **选项**：复用现有的5种天气图标
  - 🌞 阳光（对应：愉悦）
  - ☁️ 多云（对应：平静）
  - 🌧️ 阴天（对应：疲惫）
  - 🌦️ 小雨（对应：迷茫）
  - ⛈️ 大雨（对应：焦虑）
- **说明**：用于了解用户的整体情绪基调

## 交互设计

### 显示时机
- **首次使用**：在用户首次打开应用时显示
- **后续修改**：可在设置页面中重新填写

### 页面形式
- **选项A**：独立页面（全屏显示，类似引导页）
- **选项B**：弹窗/模态框（居中显示，背景半透明）
- **选项C**：侧边滑入（从右侧滑入，类似设置面板）

### 导航方式
- **必填项**：必须填写才能进入下一步
- **非必填项**：
  - 显示"跳过"按钮
  - 或直接显示"下一步"按钮（可跳过）
  - 或显示"跳过"和"下一步"两个按钮

### 进度指示
- 显示进度条或步骤指示器（如：1/6, 2/6...）
- 已完成步骤可点击返回修改

### 完成后的处理
- 保存到 localStorage
- 显示欢迎信息（如："欢迎，{称呼}！"）
- 跳转到主界面或每日占卜界面

## 数据存储

### 数据结构
```javascript
{
  nickname: "小A",              // 称呼
  gender: "女",                 // 性别：男/女/非二元
  birthday: "1990-01-01",       // 生日：YYYY-MM-DD
  birthTime: "14:00",          // 出生时间：HH:mm 或 null
  birthPlace: "北京",          // 出生地：城市名称 或 null
  defaultWeather: "sunny",     // 默认天气：sunny/cloudy/overcast/rainy/stormy 或 null
  zodiac: "摩羯座",            // 自动计算的星座
  completedAt: "2024-01-01T10:00:00Z"  // 完成时间
}
```

### 存储位置
- **localStorage**：存储在浏览器本地
- **key**：`userProfile` 或 `userInfo`

## 需要确认的问题

### 1. 第1步"希望怎么称呼你"是否必填？
- [ ] 必填
- [ ] 非必填（可跳过）

### 2. UI显示形式
- [ ] 选项A：独立页面（全屏）
- [ ] 选项B：弹窗/模态框
- [ ] 选项C：侧边滑入

### 3. 非必填项的跳步方式
- [ ] 显示"跳过"按钮（点击跳过，或填写后点击"下一步"）
- [ ] 直接显示"下一步"按钮（可留空直接下一步）
- [ ] 显示"跳过"和"下一步"两个按钮

### 4. 生日选择器形式
- [ ] 日期选择器（原生或第三方组件）
- [ ] 手动输入（年月日三个输入框）
- [ ] 下拉选择（年月日三个下拉框）

### 5. 出生地输入方式
- [ ] 纯文本输入
- [ ] 文本输入 + 地理位置自动识别
- [ ] 城市选择器（下拉列表）

### 6. 出生时间选择器
- [ ] 小时选择器（00-23）
- [ ] 小时+分钟选择器（00:00-23:59）
- [ ] 时间段选择（上午/下午/晚上 + 小时）

### 7. 完成后的跳转逻辑
- [ ] 跳转到每日占卜界面
- [ ] 跳转到主界面（如果已有今日占卜）
- [ ] 显示欢迎页面，然后自动跳转

### 8. 数据验证规则
- **生日**：不能是未来日期，不能超过合理范围（如1900年之前）
- **称呼**：字符长度限制（建议2-10个字符）
- **出生地**：是否需要验证城市名称有效性？

### 9. 修改个人信息
- [ ] 在设置页面提供"编辑个人信息"入口
- [ ] 修改后是否需要重新验证？

### 10. 隐私和安全
- [ ] 是否需要隐私政策说明？
- [ ] 数据是否加密存储？

## 技术实现建议

### 星座计算
- 使用现有的月相计算逻辑或新增星座计算函数
- 根据生日自动计算星座

### 天气图标复用
- 复用现有的 `EMOTION_WEATHER_MAP` 映射
- 保持图标和情绪的一致性

### 表单验证
- 实时验证输入有效性
- 显示错误提示信息

### 响应式设计
- 移动端和桌面端适配
- 保持与现有UI风格一致

## 后续使用场景

### 占卜内容个性化
- 在生成占卜内容时，使用用户信息（如称呼、性别、星座）
- 提供更个性化的解读和建议

### 疗愈内容定制
- 根据用户的默认天气（情绪基调）调整内容
- 结合星座特点提供针对性建议

### 数据分析
- 统计用户特征分布
- 优化占卜算法和内容生成

